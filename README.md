## turtleGL

### 基于turtle库和赤石技术的3D绘图库

面向对象，直观明了，赤石科技。

### 使用方式

下载turtleGL.py，置于项目根目录。

导入
```python
import turtleGL
```

### 数据结构

使用分离的摄像头对象、场景对象实现。

场景对象可将数据存储于自身，可被摄像头对象指定并调用。

可使用多个摄像头，灵活切换。

#### 摄像头属性

可直接为摄像头对象的属性重新赋值。

```python
camera_position#摄像头位置[x,y,z]，正上方向为[0,0,1]
camera_direction#摄像头朝向[x,y,z]
camera_rotation#摄像头旋转角，具体体现为左右倾斜，使用弧度角
camera_focal#摄像头焦距
ray#光线方向，本项目没有光栅算法，这里仅用于判断面是否面向光源
rend#渲染类型 0 材质预览 1 阴影模式 2 法线预览
shade_value#正片叠底系数 0-255
pensize#画笔大小，只对线生效
pencolor#画笔颜色，只对线生效
type#相机类型 0 斜2侧模式 1 透视模式
```

##### 材质预览模式

面直接显示指定的颜色。

##### 阴影模式

本项目不包含光栅算法，所以不存在光线计算。

启用阴影模式后，面数据将根据光线方向和法线夹角计算是否属于亮面，如否则使用正片叠底系数重计算表面颜色。

##### 法线模式

显示法线，当摄像头方向与面法线余弦值大于0（即为钝角）时判定为正面，显示蓝色，反之显示红色。

#### 摄像头方法

```python
status()#输出当前摄像头属性
tracer(0)#关闭动画，直接操作turtle
to_target([x,y,z])#设置摄像头面向目标点
pointfocal([x,y,z])#透视模式下返回空间内坐标映射至摄像头的坐标
pointcabinet([x,y,z])#斜二侧模式下返回空间内坐标映射至摄像头的坐标
draw_axis(l)#画出基准坐标轴，l调节大小
drawline(linedata)#输入单个边数据，绘制边
drawface(facedata)#输入单个面坐标，绘制面
draw_from_scene(scenedata)#输入整合数据，全部绘制
delay()#延时，与turtle.delay()效果一致
clear()#清除画布，与turtle.clear()效果一致
bgcolor()#画布底色，与turtle.bgcolor()效果一致
update()#更新画布，与turtle.update()效果一致
done()#阻止自动关闭窗口，与turtle.done()效果一致
```

#### 场景属性

场景包含line、face属性，存储边/面数据。

可使用多个场景对象。

##### 数据格式

```bash
[
    [
        [点1],
        [点2],
        ...
        [点n]
    ],
    '十六进制颜色'
]
```

点个数为2时会被识别为边。

使用面数据时以法线射出方向为正，逆时针方向输入点。

场景对象的line、face属性为包含以上数据的数组，每个元素为单独的线/面数据，可直接调用或修改。

#### 场景方法

```python
addline([[x1,y1,z1],[x2,y2,z2],'16进制颜色'])#添加边
addface([[x1,y1,z1],[x2,y2,z2],...,[xn,yn,zn],'16进制颜色'])#添加面
export_line(path)#导出线数据 csv
export_face(path)#导出面数据 csv
import_line(path)#导入线数据
import_face(path)#导入面数据
sort_line_avg([相机坐标x,相机坐标y,相机坐标z])#透视模式下调整图层顺序，直接修改场景对象属性
sort_face_avg([相机坐标x,相机坐标y,相机坐标z])#透视模式下调整图层顺序，直接修改场景对象属性
sort_all_avg([相机坐标x,相机坐标y,相机坐标z])#返回调整后的所有数据，不修改场景对象属性
sort_line_cabin([相机坐标x,相机坐标y,相机坐标z])#斜二侧模式下调整图层顺序，直接修改场景对象属性
sort_face_cabin([相机坐标x,相机坐标y,相机坐标z])#斜二侧模式下调整图层顺序，直接修改场景对象属性
sort_all_cabin([相机坐标x,相机坐标y,相机坐标z])#返回调整后的所有数据，不修改场景对象属性
reverse_normvect(i)#修改第i个面数据的法向
```

##### 调整顺序

本项目不包含光栅算法，所以不存在光线计算。

面前后顺序由图层和渲染顺序决定。

#### 操作流程

1. 实例化摄像头对象
2. 调整镜头属性
3. 实例化场景对象
4. 为场景对象添加数据
5. 场景对象数据排序
6. 使用摄像头对象调用数据
7. 绘制

### 使用方式（示例）

#### 摄像头对象

设置摄像头属性。

```python
camera = turtleGL.camera()#实例化摄像头对象
camera.camera_position = [-101,-121,131]#相机位置
camera.camera_direction = [1,1,-1]#相机方向
camera.to_target([0,0,0])#相机看向目标点
camera.camera_focal = 300#焦距
camera.ray = [1,1,-1]#光照方向
camera.type = 1#1 透视模式  0 斜二侧模式
camera.rend = 1#0 材质预览 1 阴影 2 法线
camera.status()#查看摄像头属性
```

#### 场景对象

使用结构化数据存储场景信息，分为线和面，直接储存在场景对象内，可调用。

```python
scene = turtleGL.scene()#实例化场景
#边信息自定义
scene.line = [[[[50.0, 50.0, 0.0], [-50.0, 50.0, 0.0]], '#000000'], 
              [[[-50.0, 50.0, 0.0], [-50.0, -50.0, 0.0]], '#000000'], 
              [[[-50.0, -50.0, 0.0], [50.0, -50.0, 0.0]], '#000000'], 
              [[[50.0, -50.0, 0.0], [50.0, 50.0, 0.0]], '#000000'], 
              [[[50.0, 50.0, 100.0], [-50.0, 50.0, 100.0]], '#000000'], 
              [[[-50.0, 50.0, 100.0], [-50.0, -50.0, 100.0]], '#000000'], 
              [[[-50.0, -50.0, 100.0], [50.0, -50.0, 100.0]], '#000000'], 
              [[[50.0, -50.0, 100.0], [50.0, 50.0, 100.0]], '#000000'], 
              [[[50.0, 50.0, 0.0], [50.0, 50.0, 100.0]], '#000000'], 
              [[[-50.0, 50.0, 0.0], [-50.0, 50.0, 100.0]], '#000000'], 
              [[[-50.0, -50.0, 0.0], [-50.0, -50.0, 100.0]], '#000000'], 
              [[[50.0, -50.0, 0.0], [50.0, -50.0, 100.0]], '#000000']]
#面信息自定义
scene.face = [[[[50.0, 50.0, 0.0], [-50.0, 50.0, 0.0], [-50.0, -50.0, 0.0], [50.0, -50.0, 0.0]], '#FF0000'], 
              [[[50.0, 50.0, 0.0], [50.0, 50.0, 100.0], [50.0, -50.0, 100.0], [50.0, -50.0, 0.0]], '#0000FF'], 
              [[[-50.0, 50.0, 0.0], [-50.0, -50.0, 0.0], [-50.0, -50.0, 100.0], [-50.0, 50.0, 100.0]], '#FFFF00'], 
              [[[50.0, 50.0, 0.0], [-50.0, 50.0, 0.0], [-50.0, 50.0, 100.0], [50.0, 50.0, 100.0]], '#FF00FF'], 
              [[[50.0, 50.0, 100.0], [-50.0, 50.0, 100.0], [-50.0, -50.0, 100.0], [50.0, -50.0, 100.0]], '#00FF00'], 
              [[[-50.0, -50.0, 0.0], [50.0, -50.0, 0.0], [50.0, -50.0, 100.0], [-50.0, -50.0, 100.0]], '#00FFFF']]
```

整理显示次序(以透视模式为例)

```python
scene.sort_line_avg(camera.camera_position)#仅边
scene.sort_face_avg(camera.camera_position)#仅面
scene.sort_all_avg(camera.camera_position)#全部整理，直接返回结构化数据，不修改对象
```

绘制
```python
camera.draw_from_scene(scene.sort_all_avg(camera.camera_position))#绘制全部内容
camera.draw_from_scene(scene.line)#绘制 仅边
camera.draw_from_scene(scene.face)#绘制 仅面
camera.draw_axis(10)#显示轴
camera.done()
```

导入/导出
```python
#导出
scene.export_line('example_line.csv')
scene.export_face('example_face.csv')
#导入
scene.import_line('example_line.csv')
scene.import_face('example_face.csv')
```